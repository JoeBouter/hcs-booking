<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Zapato: Classes, Simple</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary-color: #4f46e5;
      --calendar-color: #7c3aed;
      --font-family: 'Inter', sans-serif;
    }
    
    body {
      font-family: var(--font-family);
    }

    .calendar-day {
    min-height: 80px;
    color: #374151; /* gray-700 */
    background-color: white;
  }

  .dark-mode .calendar-day {
    color: #f3f4f6; /* gray-100 */
    background-color: #374151; /* gray-700 */
  }

  .weekend-day {
    background-color: #f8fafc; /* gray-50 */
  }

  .dark-mode .weekend-day {
    background-color: #1f2937; /* gray-800 */
  }

  .holiday-day {
  background-color: #fff1f2; /* rose-50 */
  }
  
  .dark-mode .holiday-day {
    background-color: #4c0519; /* rose-950 */
  }
      
    .fade-in {
      animation: fadeIn 0.3s ease-in-out;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    .calendar-day {
      transition: all 0.2s ease;
    }
    
    .calendar-day:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    
    .nav-link {
      position: relative;
    }
    
    .nav-link::after {
      content: '';
      position: absolute;
      bottom: -2px;
      left: 0;
      width: 0;
      height: 2px;
      background-color: currentColor;
      transition: width 0.3s ease;
    }
    
    .nav-link:hover::after {
      width: 100%;
    }
    
    .nav-link.active::after {
      width: 100%;
    }
    
    .booking-admin {
      background-color: #fee2e2;
      color: #b91c1c;
    }
    
    .booking-teacher {
      background-color: #dbeafe;
      color: #1d4ed8;
    }
    
    .booking-student {
      background-color: #dcfce7;
      color: #166534;
    }
    
    .booking-pending {
      background-color: #fef3c7;
      color: #92400e;
    }
    
    .weekend-day {
      background-color: #f8fafc;
    }
    
    .holiday-day {
      background-color: #fff1f2;
    }
    
    .modal {
      transition: opacity 0.3s ease;
    }
    
    .avatar-upload {
      position: relative;
      overflow: hidden;
      display: inline-block;
    }
    
    .avatar-upload input[type="file"] {
      position: absolute;
      left: 0;
      top: 0;
      opacity: 0;
    }
    
    .dark-mode {
      background-color: #1a1a1a;
      color: #f3f4f6;
    }
    
    .dark-mode .bg-white {
      background-color: #2d2d2d;
      color: #f3f4f6;
    }
    
    .dark-mode .text-gray-800 {
      color: #f3f4f6;
    }
    
    .dark-mode .bg-gray-50 {
      background-color: #333333;
    }
    
    .dark-mode .border-gray-200 {
      border-color: #444444;
    }
    
    .animate-fade-in {
      animation: fadeIn 0.3s ease-in-out;
    }
    
    .animate-fade-out {
      animation: fadeOut 0.3s ease-in-out;
    }
    
    @keyframes fadeOut {
      from { opacity: 1; }
      to { opacity: 0; }
    }
    
    @media (max-width: 640px) {
      .mobile-stack {
        flex-direction: column;
      }
      
      .mobile-full {
        width: 100%;
      }
    }
  </style>
</head>
<body class="bg-gray-50 min-h-screen">
  <!-- Header -->
  <header class="bg-[color:var(--primary-color)] text-white shadow-lg">
    <div class="container mx-auto px-4 py-4">
      <div class="flex justify-between items-center">
        <div class="flex items-center space-x-3">
          <div id="siteLogo" class="w-10 h-10 bg-white rounded flex items-center justify-center overflow-hidden">
            <i class="fas fa-chalkboard-teacher text-[color:var(--primary-color)] text-xl"></i>
          </div>
          <h1 class="text-xl md:text-2xl font-bold" id="siteTitle">Zapato</h1>
        </div>
        <div class="flex items-center space-x-4">
          <button id="darkModeToggle" class="p-2 rounded-full hover:bg-black/10 transition-colors">
            <i class="fas fa-moon"></i>
          </button>
          <div id="userInfo" class="hidden">
            <div class="flex items-center space-x-2">
              <div id="userAvatar" class="w-8 h-8 rounded-full bg-indigo-500 flex items-center justify-center overflow-hidden">
                <i class="fas fa-user text-white text-sm"></i>
              </div>
              <span id="currentUser" class="font-medium hidden md:inline"></span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Navigation -->
  <nav class="bg-white shadow-md dark:bg-gray-800">
    <div class="container mx-auto px-4">
      <div id="navGuest" class="flex space-x-4 py-3">
        <button onclick="showScreen('loginScreen')" class="nav-link text-indigo-700 font-medium px-3 py-2 rounded-md hover:bg-indigo-50 transition-colors dark:text-indigo-300 dark:hover:bg-gray-700">
          <i class="fas fa-sign-in-alt mr-2"></i>Login
        </button>
        <button onclick="showScreen('registerScreen')" class="nav-link text-indigo-700 font-medium px-3 py-2 rounded-md hover:bg-indigo-50 transition-colors dark:text-indigo-300 dark:hover:bg-gray-700">
          <i class="fas fa-user-plus mr-2"></i>Register
        </button>
      </div>
      <div id="navUser" class="hidden py-3">
        <div class="flex space-x-4 mobile-stack">
          <div class="flex space-x-4">
            <button onclick="showAppTab('bookingPanel')" id="bookingTab" class="nav-link text-gray-700 font-medium px-3 py-2 rounded-md hover:bg-gray-100 transition-colors dark:text-gray-300 dark:hover:bg-gray-700">
              <i class="fas fa-calendar-plus mr-2"></i>Book Room
            </button>
            <button onclick="showAppTab('calendarPanel')" id="calendarTab" class="nav-link text-gray-700 font-medium px-3 py-2 rounded-md hover:bg-gray-100 transition-colors dark:text-gray-300 dark:hover:bg-gray-700">
              <i class="fas fa-calendar-alt mr-2"></i>Calendar
            </button>
            <button onclick="showAppTab('adminPanel')" id="adminTab" class="nav-link text-gray-700 font-medium px-3 py-2 rounded-md hover:bg-gray-100 transition-colors dark:text-gray-300 dark:hover:bg-gray-700">
              <i class="fas fa-cog mr-2"></i>Admin Panel
            </button>
          </div>
          <button onclick="logout()" class="ml-auto md:ml-0 text-red-600 font-medium px-3 py-2 rounded-md hover:bg-red-50 transition-colors dark:text-red-400 dark:hover:bg-gray-700">
            <i class="fas fa-sign-out-alt mr-2"></i>Logout
          </button>
        </div>
      </div>
    </div>
  </nav>

  <!-- Announcement Banner -->
  <div id="announcementBanner" class="bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 hidden">
    <div class="container mx-auto flex justify-between items-center">
      <div>
        <p class="font-medium" id="announcementText"></p>
      </div>
      <button onclick="hideAnnouncement()" class="text-yellow-700 hover:text-yellow-900">
        <i class="fas fa-times"></i>
      </button>
    </div>
  </div>

  <!-- Main Content -->
  <main class="container mx-auto px-4 py-8">
    <!-- Login Screen -->
    <div id="loginScreen" class="max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden fade-in dark:bg-gray-800 dark:text-white">
      <div class="p-8">
        <div class="text-center mb-6">
          <div class="w-20 h-20 mx-auto rounded-full bg-indigo-100 flex items-center justify-center mb-4 dark:bg-gray-700">
            <i class="fas fa-sign-in-alt text-indigo-600 text-3xl dark:text-indigo-400"></i>
          </div>
          <h2 class="text-2xl font-bold text-gray-800 dark:text-white">Welcome Back</h2>
          <p class="text-gray-600 dark:text-gray-300">Please login to your account</p>
        </div>
        <div class="space-y-4">
          <div>
            <label for="loginUsername" class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Username</label>
            <div class="relative">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <i class="fas fa-user text-gray-400"></i>
              </div>
              <input type="text" id="loginUsername" placeholder="Enter your username" 
                class="pl-10 w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
            </div>
          </div>
          <div>
            <label for="loginPassword" class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Password</label>
            <div class="relative">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <i class="fas fa-lock text-gray-400"></i>
              </div>
              <input type="password" id="loginPassword" placeholder="Enter your password" 
                class="pl-10 w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
            </div>
          </div>
          <button onclick="login()" 
            class="w-full bg-[color:var(--primary-color)] text-white py-2 px-4 rounded-md hover:bg-[color:var(--primary-color)]/90 transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
            <i class="fas fa-sign-in-alt mr-2"></i>Login
          </button>
        </div>
      </div>
    </div>

    <!-- Register Screen -->
    <div id="registerScreen" class="max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden hidden fade-in dark:bg-gray-800 dark:text-white">
      <div class="p-8">
        <div class="text-center mb-6">
          <div class="w-20 h-20 mx-auto rounded-full bg-indigo-100 flex items-center justify-center mb-4 dark:bg-gray-700">
            <i class="fas fa-user-plus text-indigo-600 text-3xl dark:text-indigo-400"></i>
          </div>
          <h2 class="text-2xl font-bold text-gray-800 dark:text-white">Create New Site</h2>
          <p class="text-gray-600 dark:text-gray-300">Register your organization</p>
        </div>
        <div class="space-y-4">
          <div>
            <label for="registerSite" class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Site Name</label>
            <input type="text" id="registerSite" placeholder="Your organization name" 
              class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
          </div>
          <div>
            <label for="registerUsername" class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Admin Username</label>
            <input type="text" id="registerUsername" placeholder="Admin username" 
              class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
          </div>
          <div>
            <label for="registerPassword" class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Password</label>
            <input type="password" id="registerPassword" placeholder="Create password" 
              class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
          </div>
          <div>
            <label for="registerEmail" class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Admin Email (optional)</label>
            <input type="email" id="registerEmail" placeholder="Admin email" 
              class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
          </div>
          <button onclick="register()" 
            class="w-full bg-[color:var(--primary-color)] text-white py-2 px-4 rounded-md hover:bg-[color:var(--primary-color)]/90 transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
            <i class="fas fa-check-circle mr-2"></i>Register
          </button>
        </div>
      </div>
    </div>

    <!-- App Screen -->
    <div id="appScreen" class="hidden fade-in">
      <!-- Welcome Message -->
      <div class="mb-8 bg-white rounded-lg shadow-sm p-6 dark:bg-gray-800 dark:text-white">
        <h2 class="text-xl font-semibold text-gray-800 dark:text-white">Dashboard</h2>
        <p class="text-gray-600 mt-2 dark:text-gray-300">Welcome back to your classroom booking system</p>
      </div>

      <!-- Admin Panel -->
      <section id="adminPanel" class="app-tab bg-white rounded-lg shadow-sm overflow-hidden mb-8 dark:bg-gray-800 dark:text-white">
        <div class="border-b border-gray-200 px-6 py-4 dark:border-gray-700">
          <h3 class="text-lg font-medium text-gray-900 flex items-center dark:text-white">
            <i class="fas fa-cog mr-2 text-indigo-600 dark:text-indigo-400"></i> Admin Panel
          </h3>
        </div>
        <div class="p-6">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Site Customization -->
            <div class="bg-gray-50 p-4 rounded-lg dark:bg-gray-700">
              <h4 class="font-medium text-gray-800 mb-3 flex items-center dark:text-white">
                <i class="fas fa-paint-brush mr-2 text-indigo-600 dark:text-indigo-400"></i> Site Customization
              </h4>
              <div class="space-y-4">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Site Title</label>
                  <div class="flex">
                    <input type="text" id="siteTitle" class="flex-1 px-4 py-2 border border-gray-300 rounded-l-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-600 dark:border-gray-500 dark:text-white">
                    <button onclick="updateSiteTitle()" class="bg-indigo-600 text-white px-4 py-2 rounded-r-md hover:bg-indigo-700 transition-colors">
                      <i class="fas fa-check"></i>
                    </button>
                  </div>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Site Logo</label>
                  <div class="flex items-center space-x-4">
                    <div id="logoPreview" class="w-16 h-16 bg-white rounded flex items-center justify-center overflow-hidden border border-gray-300 dark:bg-gray-600">
                      <i class="fas fa-image text-gray-400 text-xl"></i>
                    </div>
                    <div class="flex-1">
                      <label for="logoUpload" class="cursor-pointer">
                        <div class="bg-white border border-gray-300 rounded-md px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:bg-gray-600 dark:border-gray-500 dark:text-white">
                          <i class="fas fa-upload mr-2"></i> Upload Logo
                        </div>
                        <input type="file" id="logoUpload" accept="image/*" onchange="uploadLogo(event)" class="hidden">
                      </label>
                    </div>
                  </div>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Primary Color</label>
                  <div class="flex items-center">
                    <input type="color" id="siteColor" onchange="changeSiteColor()" class="h-10 w-10 rounded border border-gray-300">
                    <span class="ml-2 text-sm text-gray-500 dark:text-gray-300">Change site theme</span>
                  </div>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Calendar Color</label>
                  <div class="flex items-center">
                    <input type="color" id="calendarColor" onchange="changeCalendarColor()" class="h-10 w-10 rounded border border-gray-300">
                    <span class="ml-2 text-sm text-gray-500 dark:text-gray-300">Change calendar color</span>
                  </div>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Announcement</label>
                  <textarea id="announcementInput" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-600 dark:border-gray-500 dark:text-white" placeholder="Enter announcement for all users"></textarea>
                  <button onclick="updateAnnouncement()" class="mt-2 bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 transition-colors">
                    <i class="fas fa-bullhorn mr-1"></i> Post Announcement
                  </button>
                  <div class="mt-2">
                    <label for="maxAdvanceDays" class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Max Advance Booking Days</label>
                    <input type="number" id="maxAdvanceDays" min="1" max="365" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-600 dark:border-gray-500 dark:text-white">
                    <button onclick="updateMaxAdvanceDays()" class="mt-2 bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 transition-colors">
                      <i class="fas fa-save mr-1"></i> Save
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Data Management -->
            <div class="bg-gray-50 p-4 rounded-lg dark:bg-gray-700">
              <h4 class="font-medium text-gray-800 mb-3 flex items-center dark:text-white">
                <i class="fas fa-database mr-2 text-indigo-600 dark:text-indigo-400"></i> Data Management
              </h4>
              <div class="space-y-3">
                <button onclick="exportData()" class="w-full flex items-center justify-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 dark:bg-gray-600 dark:border-gray-500 dark:text-white dark:hover:bg-gray-500">
                  <i class="fas fa-file-export mr-2"></i> Export Data
                </button>
                <div class="relative">
                  <label for="file-upload" class="w-full flex items-center justify-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 dark:bg-gray-600 dark:border-gray-500 dark:text-white dark:hover:bg-gray-500 cursor-pointer">
                    <i class="fas fa-file-import mr-2"></i> Import Data
                  </label>
                  <input id="file-upload" type="file" onchange="importData(event)" class="sr-only">
                </div>
                <button onclick="exportCSV()" class="w-full flex items-center justify-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 dark:bg-gray-600 dark:border-gray-500 dark:text-white dark:hover:bg-gray-500">
                  <i class="fas fa-file-csv mr-2"></i> Export as CSV
                </button>
                <button onclick="printCalendar()" class="w-full flex items-center justify-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 dark:bg-gray-600 dark:border-gray-500 dark:text-white dark:hover:bg-gray-500">
                  <i class="fas fa-print mr-2"></i> Print Calendar
                </button>
              </div>
            </div>
          </div>

          <!-- Room Management -->
          <div class="mt-6 bg-gray-50 p-4 rounded-lg dark:bg-gray-700">
            <h4 class="font-medium text-gray-800 mb-3 flex items-center dark:text-white">
              <i class="fas fa-door-open mr-2 text-indigo-600 dark:text-indigo-400"></i> Room Management
            </h4>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label for="newRoomName" class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Room Name</label>
                <input type="text" id="newRoomName" placeholder="New room name" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-600 dark:border-gray-500 dark:text-white">
              </div>
              <div>
                <label for="roomCapacity" class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Capacity</label>
                <input type="number" id="roomCapacity" placeholder="Max people" min="1" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-600 dark:border-gray-500 dark:text-white">
              </div>
            </div>
            <div class="mt-3 grid grid-cols-1 md:grid-cols-3 gap-3">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Access Level</label>
                <select id="roomAccess" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-600 dark:border-gray-500 dark:text-white">
                  <option value="all">All Users</option>
                  <option value="teachers">Teachers Only</option>
                  <option value="admins">Admins Only</option>
                </select>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Requires Approval</label>
                <select id="roomApproval" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-600 dark:border-gray-500 dark:text-white">
                  <option value="no">No</option>
                  <option value="yes">Yes</option>
                </select>
              </div>
              <div class="flex items-end">
                <button onclick="addRoom()" class="w-full bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 transition-colors">
                  <i class="fas fa-plus mr-1"></i> Add Room
                </button>
              </div>
            </div>
            <div class="mt-4">
              <h5 class="text-sm font-medium text-gray-700 mb-2 dark:text-gray-300">Existing Rooms</h5>
              <ul id="roomList" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-2">
                <!-- Rooms will be populated here -->
              </ul>
            </div>
          </div>

          <!-- User Management -->
          <div class="mt-6 bg-gray-50 p-4 rounded-lg dark:bg-gray-700">
            <h4 class="font-medium text-gray-800 mb-3 flex items-center dark:text-white">
              <i class="fas fa-users mr-2 text-indigo-600 dark:text-indigo-400"></i> User Management
            </h4>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <h5 class="text-sm font-medium text-gray-700 mb-2 dark:text-gray-300">Create New User</h5>
                <div class="space-y-3">
                  <div>
                    <label for="newUsername" class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Username</label>
                    <input type="text" id="newUsername" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-600 dark:border-gray-500 dark:text-white">
                  </div>
                  <div>
                    <label for="newPassword" class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Password</label>
                    <input type="password" id="newPassword" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-600 dark:border-gray-500 dark:text-white">
                  </div>
                  <div>
                    <label for="newEmail" class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Email (optional)</label>
                    <input type="email" id="newEmail" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-600 dark:border-gray-500 dark:text-white">
                  </div>
                  <div>
                    <label for="newRole" class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Role</label>
                    <select id="newRole" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-600 dark:border-gray-500 dark:text-white">
                      <option value="admin">Admin</option>
                      <option value="teacher">Teacher</option>
                      <option value="student">Student</option>
                    </select>
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Profile Picture</label>
                    <div class="avatar-upload">
                      <div class="flex items-center space-x-4">
                        <div id="avatarPreview" class="w-12 h-12 rounded-full bg-indigo-100 flex items-center justify-center overflow-hidden border border-gray-300 dark:bg-gray-600">
                          <i class="fas fa-user text-gray-400"></i>
                        </div>
                        <label for="avatarInput" class="cursor-pointer">
                          <div class="bg-white border border-gray-300 rounded-md px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:bg-gray-600 dark:border-gray-500 dark:text-white">
                            <i class="fas fa-upload mr-2"></i> Upload
                          </div>
                          <input type="file" id="avatarInput" accept="image/*" onchange="previewAvatar(event)" class="hidden">
                        </label>
                      </div>
                    </div>
                  </div>
                  <button onclick="createUser()" class="w-full bg-indigo-600 text-white py-2 px-4 rounded-md hover:bg-indigo-700 transition-colors">
                    <i class="fas fa-user-plus mr-1"></i> Create User
                  </button>
                </div>
              </div>
              <div>
                <h5 class="text-sm font-medium text-gray-700 mb-2 dark:text-gray-300">Bulk User Creation</h5>
                <textarea id="bulkUsers" rows="8" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-600 dark:border-gray-500 dark:text-white" placeholder="Format: S,username,password,email, T,username,password,email, A,username,password,email"></textarea>
                <p class="text-xs text-gray-500 mt-1 dark:text-gray-400">S = Student, T = Teacher, A = Admin (separate entries with commas)</p>
                <button onclick="bulkCreateUsers()" class="mt-2 bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 transition-colors">
                    <i class="fas fa-user-plus mr-1"></i> Create Users
                </button>
              </div>
            </div>
            <div class="mt-4">
              <h5 class="text-sm font-medium text-gray-700 mb-2 dark:text-gray-300">Existing Users</h5>
              <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-600">
                  <thead class="bg-gray-100 dark:bg-gray-600">
                    <tr>
                      <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-300">User</th>
                      <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-300">Role</th>
                      <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-300">Email</th>
                      <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-300">Actions</th>
                    </tr>
                  </thead>
                  <tbody id="userList" class="bg-white divide-y divide-gray-200 dark:bg-gray-700 dark:divide-gray-600">
                    <!-- Users will be populated here -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>

          <!-- Period Management -->
          <div class="mt-6 bg-gray-50 p-4 rounded-lg dark:bg-gray-700">
            <h4 class="font-medium text-gray-800 mb-3 flex items-center dark:text-white">
              <i class="fas fa-clock mr-2 text-indigo-600 dark:text-indigo-400"></i> Period Management
            </h4>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <h5 class="text-sm font-medium text-gray-700 mb-2 dark:text-gray-300">Current Periods</h5>
                <ul id="periodList" class="space-y-2">
                  <!-- Periods will be populated here -->
                </ul>
              </div>
              <div>
                <h5 class="text-sm font-medium text-gray-700 mb-2 dark:text-gray-300">Add/Edit Period</h5>
                <div class="space-y-3">
                  <div>
                    <label for="periodName" class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Period Name</label>
                    <input type="text" id="periodName" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-600 dark:border-gray-500 dark:text-white">
                  </div>
                  <div class="grid grid-cols-2 gap-3">
                    <div>
                      <label for="periodStart" class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Start Time</label>
                      <input type="time" id="periodStart" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-600 dark:border-gray-500 dark:text-white">
                    </div>
                    <div>
                      <label for="periodEnd" class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">End Time</label>
                      <input type="time" id="periodEnd" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-600 dark:border-gray-500 dark:text-white">
                    </div>
                  </div>
                  <div class="flex space-x-3">
                    <button onclick="addPeriod()" class="flex-1 bg-indigo-600 text-white py-2 px-4 rounded-md hover:bg-indigo-700 transition-colors">
                      <i class="fas fa-plus mr-1"></i> Add Period
                    </button>
                    <button onclick="updatePeriod()" class="flex-1 bg-yellow-600 text-white py-2 px-4 rounded-md hover:bg-yellow-700 transition-colors">
                      <i class="fas fa-edit mr-1"></i> Update Period
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Holiday Management -->
          <div class="mt-6 bg-gray-50 p-4 rounded-lg dark:bg-gray-700">
            <h4 class="font-medium text-gray-800 mb-3 flex items-center dark:text-white">
              <i class="fas fa-umbrella-beach mr-2 text-indigo-600 dark:text-indigo-400"></i> Holiday Management
            </h4>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <h5 class="text-sm font-medium text-gray-700 mb-2 dark:text-gray-300">Add Holiday</h5>
                <div class="space-y-3">
                  <div>
                    <label for="holidayName" class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Holiday Name</label>
                    <input type="text" id="holidayName" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-600 dark:border-gray-500 dark:text-white">
                  </div>
                  <div>
                    <label for="holidayDate" class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Date</label>
                    <input type="date" id="holidayDate" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-600 dark:border-gray-500 dark:text-white">
                  </div>
                  <button onclick="addHoliday()" class="w-full bg-indigo-600 text-white py-2 px-4 rounded-md hover:bg-indigo-700 transition-colors">
                    <i class="fas fa-plus mr-1"></i> Add Holiday
                  </button>
                </div>
              </div>
              <div>
                <h5 class="text-sm font-medium text-gray-700 mb-2 dark:text-gray-300">Current Holidays</h5>
                <ul id="holidayList" class="space-y-2">
                  <!-- Holidays will be populated here -->
                </ul>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Booking Panel -->
      <section id="bookingPanel" class="app-tab hidden bg-white rounded-lg shadow-sm overflow-hidden mb-8 dark:bg-gray-800 dark:text-white">
        <div class="border-b border-gray-200 px-6 py-4 dark:border-gray-700">
          <h3 class="text-lg font-medium text-gray-900 flex items-center dark:text-white">
            <i class="fas fa-calendar-plus mr-2 text-indigo-600 dark:text-indigo-400"></i> Book a Room
          </h3>
        </div>
        <div class="p-6">
          <form onsubmit="submitBooking(event)" class="max-w-lg mx-auto">
            <div class="space-y-5">
              <div>
                <label for="date" class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Date</label>
                <div class="relative">
                  <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                    <i class="fas fa-calendar-day text-gray-400"></i>
                  </div>
                  <input type="date" id="date" required min="" class="pl-10 w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                </div>
              </div>
              
              <div>
                <label for="roomSelect" class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Room</label>
                <div class="relative">
                  <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                    <i class="fas fa-door-open text-gray-400"></i>
                  </div>
                  <select id="roomSelect" required class="pl-10 w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                    <!-- Rooms will be populated here -->
                  </select>
                </div>
              </div>
              
              <div>
                <label for="period" class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Period</label>
                <div class="relative">
                  <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                    <i class="fas fa-clock text-gray-400"></i>
                  </div>
                  <select id="period" required class="pl-10 w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                    <!-- Periods will be populated here -->
                  </select>
                </div>
              </div>
              
              <div id="recurringOptions" class="hidden">
                <label class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Recurring Booking</label>
                <div class="space-y-2">
                  <div class="flex items-center">
                    <input type="checkbox" id="recurringCheck" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600">
                    <label for="recurringCheck" class="ml-2 block text-sm text-gray-700 dark:text-gray-300">Repeat weekly</label>
                  </div>
                  <div id="recurringDetails" class="hidden space-y-2">
                    <div>
                      <label for="recurringWeeks" class="block text-sm text-gray-700 dark:text-gray-300">For how many weeks?</label>
                      <input type="number" id="recurringWeeks" min="1" max="12" value="4" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                    </div>
                  </div>
                </div>
              </div>
              
              <div>
                <label for="bookingNotes" class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Notes (optional)</label>
                <textarea id="bookingNotes" rows="2" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white" placeholder="Any additional information about your booking"></textarea>
              </div>
              
              <button type="submit" class="w-full bg-[color:var(--primary-color)] text-white py-2 px-4 rounded-md hover:bg-[color:var(--primary-color)]/90 transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
                <i class="fas fa-check-circle mr-2"></i> Submit Booking
              </button>
            </div>
          </form>
        </div>
      </section>

      <!-- Calendar Panel -->
      <section id="calendarPanel" class="app-tab hidden bg-white rounded-lg shadow-sm overflow-hidden mb-8 dark:bg-gray-800 dark:text-white">
        <div class="border-b border-gray-200 px-6 py-4 dark:border-gray-700">
          <div class="flex items-center justify-between mobile-stack">
            <h3 class="text-lg font-medium text-gray-900 flex items-center dark:text-white">
              <i class="fas fa-calendar-alt mr-2 text-indigo-600 dark:text-indigo-400"></i> Booking Calendar
            </h3>
            <div class="flex items-center space-x-2 mt-2 md:mt-0">
              <select id="calendarView" onchange="changeCalendarView()" class="px-3 py-1 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                <option value="month">Month View</option>
                <option value="week">Week View</option>
                <option value="day">Day View</option>
              </select>
              <select id="roomFilter" onchange="renderCalendar()" class="px-3 py-1 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                <option value="all">All Rooms</option>
                <!-- Rooms will be populated here -->
              </select>
              <button onclick="changeMonth(-1)" class="p-2 rounded-full hover:bg-gray-100 transition-colors dark:hover:bg-gray-700">
                <i class="fas fa-chevron-left text-gray-600 dark:text-gray-300"></i>
              </button>
              <span id="currentMonthYear" class="font-medium text-gray-700 dark:text-white">Month Year</span>
              <button onclick="changeMonth(1)" class="p-2 rounded-full hover:bg-gray-100 transition-colors dark:hover:bg-gray-700">
                <i class="fas fa-chevron-right text-gray-600 dark:text-gray-300"></i>
              </button>
            </div>
          </div>
        </div>
        <div class="p-6">
          <!-- Month View -->
          <div id="monthView" class="overflow-x-auto">
            <div id="calendarGrid" class="grid grid-cols-7 gap-2 min-w-max">
              <!-- Calendar will be populated here -->
            </div>
          </div>
          
          <!-- Week View -->
          <div id="weekView" class="hidden">
            <div class="overflow-x-auto">
              <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-600">
                <thead>
                  <tr>
                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-300">Time</th>
                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-300">Monday</th>
                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-300">Tuesday</th>
                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-300">Wednesday</th>
                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-300">Thursday</th>
                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-300">Friday</th>
                  </tr>
                </thead>
                <tbody id="weekGrid" class="bg-white divide-y divide-gray-200 dark:bg-gray-800 dark:divide-gray-600">
                  <!-- Week view will be populated here -->
                </tbody>
              </table>
            </div>
          </div>
          
          <!-- Day View -->
          <div id="dayView" class="hidden">
            <div class="overflow-x-auto">
              <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-600">
                <thead>
                  <tr>
                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-300">Time</th>
                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-300">Room 1</th>
                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-300">Room 2</th>
                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-300">Room 3</th>
                    <!-- More rooms will be added dynamically -->
                  </tr>
                </thead>
                <tbody id="dayGrid" class="bg-white divide-y divide-gray-200 dark:bg-gray-800 dark:divide-gray-600">
                  <!-- Day view will be populated here -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </section>
    </div>
  </main>

  <!-- Booking Details Modal -->
  <div id="bookingModal" class="fixed inset-0 z-50 hidden overflow-y-auto">
    <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
      <div class="fixed inset-0 transition-opacity" aria-hidden="true">
        <div class="absolute inset-0 bg-gray-500 opacity-75"></div>
      </div>
      <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
      <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full dark:bg-gray-800">
        <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4 dark:bg-gray-800">
          <div class="sm:flex sm:items-start">
            <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left">
              <h3 class="text-lg leading-6 font-medium text-gray-900 dark:text-white" id="modalTitle">Booking Details</h3>
              <div class="mt-2">
                <div id="bookingDetails" class="text-sm text-gray-500 dark:text-gray-300">
                  <!-- Booking details will be populated here -->
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse dark:bg-gray-700">
          <button type="button" onclick="closeModal()" class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-indigo-600 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:ml-3 sm:w-auto sm:text-sm">
            Close
          </button>
          <button id="approveButton" type="button" onclick="approveBooking()" class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-green-600 text-base font-medium text-white hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm hidden">
            Approve
          </button>
          <button id="editButton" type="button" onclick="editBooking()" class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-yellow-600 text-base font-medium text-white hover:bg-yellow-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm hidden">
            Edit
          </button>
          <button id="deleteButton" type="button" onclick="deleteBooking()" class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm hidden">
            Delete
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Edit Booking Modal -->
  <div id="editBookingModal" class="fixed inset-0 z-50 hidden overflow-y-auto">
    <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
      <div class="fixed inset-0 transition-opacity" aria-hidden="true">
        <div class="absolute inset-0 bg-gray-500 opacity-75"></div>
      </div>
      <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
      <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full dark:bg-gray-800">
        <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4 dark:bg-gray-800">
          <div class="sm:flex sm:items-start">
            <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full">
              <h3 class="text-lg leading-6 font-medium text-gray-900 dark:text-white">Edit Booking</h3>
              <div class="mt-2 space-y-4">
                <input type="hidden" id="editBookingId">
                <div>
                  <label for="editDate" class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Date</label>
                  <input type="date" id="editDate" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                </div>
                <div>
                  <label for="editRoom" class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Room</label>
                  <select id="editRoom" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                    <!-- Rooms will be populated here -->
                  </select>
                </div>
                <div>
                  <label for="editPeriod" class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Period</label>
                  <select id="editPeriod" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                    <!-- Periods will be populated here -->
                  </select>
                </div>
                <div>
                  <label for="editNotes" class="block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300">Notes</label>
                  <textarea id="editNotes" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"></textarea>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse dark:bg-gray-700">
          <button type="button" onclick="saveEditedBooking()" class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-indigo-600 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:ml-3 sm:w-auto sm:text-sm">
            Save Changes
          </button>
          <button type="button" onclick="closeEditModal()" class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm dark:bg-gray-600 dark:text-white dark:hover:bg-gray-500">
            Cancel
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast Notification -->
  <div id="toast" class="fixed bottom-4 right-4 hidden">
    <div class="bg-gray-800 text-white px-4 py-3 rounded-lg shadow-lg flex items-center">
      <span id="toastMessage"></span>
      <button onclick="hideToast()" class="ml-4 text-gray-300 hover:text-white">
        <i class="fas fa-times"></i>
      </button>
    </div>
  </div>

  <script>
    /* ====================== DATA ====================== */
    let siteData = JSON.parse(localStorage.getItem('siteData')) || {
      siteName: 'Default Site',
      users: [],
      rooms: [],
      bookings: [],
      periods: [
        { name: 'Period 1', start: '08:00', end: '09:00' },
        { name: 'Period 2', start: '09:00', end: '10:00' },
        { name: 'Period 3', start: '10:00', end: '11:00' },
        { name: 'Lunch', start: '11:00', end: '12:00' },
        { name: 'Period 4', start: '12:00', end: '13:00' }
      ],
      holidays: [],
      color: '#4f46e5', // indigo-600
      calendarColor: '#7c3aed', // indigo-700
      announcement: '',
      logo: null,
      maxAdvanceDays: 30
    };
    
    let currentUser = null;
    let currentMonth = new Date().getMonth();
    let currentYear = new Date().getFullYear();
    let currentWeek = getWeekNumber(new Date());
    let currentDay = new Date();
    let selectedBooking = null;
    let selectedPeriod = null;
    let darkMode = false;

    /* ====================== INITIALIZATION ====================== */
    document.addEventListener('DOMContentLoaded', function() {
      // Set color pickers to current values
      document.getElementById('siteColor').value = siteData.color;
      document.getElementById('calendarColor').value = siteData.calendarColor;
      document.getElementById('siteTitle').value = siteData.siteName;
      document.getElementById('announcementInput').value = siteData.announcement;
      document.getElementById('maxAdvanceDays').value = siteData.maxAdvanceDays;
      
      // Set min date for booking (today)
      const today = new Date().toISOString().split('T')[0];
      document.getElementById('date').min = today;
      
      // Set max date for booking (today + maxAdvanceDays)
      const maxDate = new Date();
      maxDate.setDate(maxDate.getDate() + siteData.maxAdvanceDays);
      document.getElementById('date').max = maxDate.toISOString().split('T')[0];
      
      // Check if user is already logged in
      const loggedInUser = localStorage.getItem('currentUser');
      if (loggedInUser) {
        currentUser = JSON.parse(loggedInUser);
        showAppScreen();
      }
      
      // Load logo if exists
      if (siteData.logo) {
        document.getElementById('logoPreview').innerHTML = `<img src="${siteData.logo}" class="w-full h-full object-cover">`;
      }
      
      // Check for dark mode preference
      if (localStorage.getItem('darkMode') === 'true') {
        toggleDarkMode();
      }
      
      // Set up event listeners
      document.getElementById('darkModeToggle').addEventListener('click', toggleDarkMode);
    });

    /* ====================== UTILITY FUNCTIONS ====================== */
    function getWeekNumber(d) {
      d = new Date(Date.UTC(d.getFullYear(), d.getMonth(), d.getDate()));
      d.setUTCDate(d.getUTCDate() + 4 - (d.getUTCDay() || 7));
      const yearStart = new Date(Date.UTC(d.getUTCFullYear(), 0, 1));
      return Math.ceil(((d - yearStart) / 86400000 + 1) / 7);
    }
    
    function formatDate(dateStr) {
      const date = new Date(dateStr);
      return date.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
    }
    
    function formatTime(timeStr) {
      const [hours, minutes] = timeStr.split(':');
      const hour = parseInt(hours);
      const ampm = hour >= 12 ? 'PM' : 'AM';
      const hour12 = hour % 12 || 12;
      return `${hour12}:${minutes} ${ampm}`;
    }
    
    function generateId() {
      return Date.now().toString(36) + Math.random().toString(36).substr(2);
    }
    
    function isHoliday(date) {
      const dateStr = date.toISOString().split('T')[0];
      return siteData.holidays.some(h => h.date === dateStr);
    }
    
    function isWeekend(date) {
      return date.getDay() === 0 || date.getDay() === 6;
    }

    /* ====================== SAVE DATA ====================== */
    function saveData() {
      localStorage.setItem('siteData', JSON.stringify(siteData));
    }

    /* ====================== TOAST NOTIFICATIONS ====================== */
    function showToast(message) {
      const toast = document.getElementById('toast');
      const toastMessage = document.getElementById('toastMessage');
      
      toastMessage.textContent = message;
      toast.classList.remove('hidden');
      toast.classList.add('animate-fade-in');
      
      setTimeout(hideToast, 5000);
    }

    function hideToast() {
      const toast = document.getElementById('toast');
      toast.classList.add('animate-fade-out');
      setTimeout(() => {
        toast.classList.remove('animate-fade-in', 'animate-fade-out');
        toast.classList.add('hidden');
      }, 300);
    }

    /* ====================== MODAL MANAGEMENT ====================== */
    function showModal(booking) {
      selectedBooking = booking;
      const modal = document.getElementById('bookingModal');
      const modalTitle = document.getElementById('modalTitle');
      const bookingDetails = document.getElementById('bookingDetails');
      const approveButton = document.getElementById('approveButton');
      const editButton = document.getElementById('editButton');
      const deleteButton = document.getElementById('deleteButton');
      
      // Set modal title
      modalTitle.textContent = booking.status === 'pending' ? 'Pending Booking' : 'Booking Details';
      
      // Populate booking details
      const room = siteData.rooms.find(r => r.name === booking.room) || { name: booking.room };
      const period = siteData.periods.find(p => p.name === booking.period) || { name: booking.period };
      
      let detailsHTML = `
        <div class="space-y-2">
          <div><strong>Date:</strong> ${formatDate(booking.date)}</div>
          <div><strong>Room:</strong> ${room.name} ${room.capacity ? `(Capacity: ${room.capacity})` : ''}</div>
          <div><strong>Period:</strong> ${period.name} ${period.start ? `(${formatTime(period.start)} - ${formatTime(period.end)})` : ''}</div>
          <div><strong>Booked by:</strong> ${booking.user}</div>
          ${booking.notes ? `<div><strong>Notes:</strong> ${booking.notes}</div>` : ''}
          ${booking.status === 'pending' ? '<div class="text-yellow-600 font-medium">Status: Pending Approval</div>' : ''}
        </div>
      `;
      
      bookingDetails.innerHTML = detailsHTML;
      
      // Show appropriate buttons based on user role and booking status
      approveButton.classList.add('hidden');
      editButton.classList.add('hidden');
      deleteButton.classList.add('hidden');
      
      if (currentUser.role === 'admin') {
        if (booking.status === 'pending') {
          approveButton.classList.remove('hidden');
        }
        editButton.classList.remove('hidden');
        deleteButton.classList.remove('hidden');
      } else if (currentUser.role === 'teacher' && booking.user === currentUser.username) {
        editButton.classList.remove('hidden');
        deleteButton.classList.remove('hidden');
      }
      
      modal.classList.remove('hidden');
    }
    
    function closeModal() {
      document.getElementById('bookingModal').classList.add('hidden');
      selectedBooking = null;
    }
    
    function showEditModal() {
      const modal = document.getElementById('editBookingModal');
      const roomSelect = document.getElementById('editRoom');
      const periodSelect = document.getElementById('editPeriod');
      
      // Populate room select
      roomSelect.innerHTML = '';
      siteData.rooms.forEach(room => {
        const option = document.createElement('option');
        option.value = room.name;
        option.textContent = room.name;
        if (room.name === selectedBooking.room) option.selected = true;
        roomSelect.appendChild(option);
      });
      
      // Populate period select
      periodSelect.innerHTML = '';
      siteData.periods.forEach(period => {
        const option = document.createElement('option');
        option.value = period.name;
        option.textContent = period.name;
        if (period.name === selectedBooking.period) option.selected = true;
        periodSelect.appendChild(option);
      });
      
      // Set current values
      document.getElementById('editBookingId').value = selectedBooking.id;
      document.getElementById('editDate').value = selectedBooking.date;
      document.getElementById('editNotes').value = selectedBooking.notes || '';
      
      modal.classList.remove('hidden');
    }
    
    function closeEditModal() {
      document.getElementById('editBookingModal').classList.add('hidden');
    }

    /* ====================== SCREEN MANAGEMENT ====================== */
    function showScreen(screen) {
      document.getElementById('loginScreen').classList.add('hidden');
      document.getElementById('registerScreen').classList.add('hidden');
      document.getElementById('appScreen').classList.add('hidden');
      
      document.getElementById(screen).classList.remove('hidden');
      document.getElementById(screen).classList.add('fade-in');
    }

    function showAppScreen() {
      showScreen('appScreen');
      document.getElementById('navGuest').classList.add('hidden');
      document.getElementById('navUser').classList.remove('hidden');
      document.getElementById('userInfo').classList.remove('hidden');
      
      document.getElementById('currentUser').textContent = `${currentUser.username} (${currentUser.role})`;
      
      // Load user avatar if exists
      if (currentUser.avatar) {
        document.getElementById('userAvatar').innerHTML = `<img src="${currentUser.avatar}" class="w-full h-full object-cover">`;
      }
      
      // Set active tab
      showAppTab('calendarPanel');
      loadApp();
      
      // Show announcement if exists
      if (siteData.announcement) {
        document.getElementById('announcementText').textContent = siteData.announcement;
        document.getElementById('announcementBanner').classList.remove('hidden');
      }
    }

    function showAppTab(tabId) {
      // Hide all tabs
      document.querySelectorAll('.app-tab').forEach(tab => {
        tab.classList.add('hidden');
      });
      
      // Show selected tab
      document.getElementById(tabId).classList.remove('hidden');
      
      // Update active nav link
      document.querySelectorAll('.nav-link').forEach(link => {
        link.classList.remove('active', 'text-indigo-700');
        link.classList.add('text-gray-700');
      });
      
      const activeLink = document.querySelector(`button[onclick="showAppTab('${tabId}')"]`);
      if (activeLink) {
        activeLink.classList.add('active', 'text-indigo-700');
        activeLink.classList.remove('text-gray-700');
      }
      
      // If calendar tab, render appropriate view
      if (tabId === 'calendarPanel') {
        renderCalendar();
      }
    }

    /* ====================== AUTHENTICATION ====================== */
    function register() {
      const site = document.getElementById('registerSite').value.trim();
      const user = document.getElementById('registerUsername').value.trim();
      const pass = document.getElementById('registerPassword').value.trim();
      const email = document.getElementById('registerEmail').value.trim();
      
      if (!site || !user || !pass) {
        showToast("Please fill in all required fields.");
        return;
      }
      
      siteData = {
        siteName: site,
        users: [{
          username: user, 
          password: pass, 
          role: 'admin',
          email: email || null,
          avatar: null
        }],
        rooms: [],
        bookings: [],
        periods: [
          { name: 'Period 1', start: '08:00', end: '09:00' },
          { name: 'Period 2', start: '09:00', end: '10:00' },
          { name: 'Period 3', start: '10:00', end: '11:00' },
          { name: 'Lunch', start: '11:00', end: '12:00' },
          { name: 'Period 4', start: '12:00', end: '13:00' }
        ],
        holidays: [],
        color: '#4f46e5',
	calendarColor: '#7c3aed',
        announcement: '',
        logo: null,
        maxAdvanceDays: 30
      };
      
      saveData();
      currentUser = siteData.users[0];
      localStorage.setItem('currentUser', JSON.stringify(currentUser));
      showAppScreen();
      showToast('Registration successful!');
    }

    function login() {
      const username = document.getElementById('loginUsername').value.trim();
      const password = document.getElementById('loginPassword').value.trim();
      
      const user = siteData.users.find(u => u.username === username && u.password === password);
      
      if (user) {
        currentUser = user;
        localStorage.setItem('currentUser', JSON.stringify(currentUser));
        showAppScreen();
        showToast('Login successful!');
      } else {
        showToast('Invalid username or password');
      }
    }

    function logout() {
      currentUser = null;
      localStorage.removeItem('currentUser');
      showScreen('loginScreen');
      document.getElementById('navGuest').classList.remove('hidden');
      document.getElementById('navUser').classList.add('hidden');
      document.getElementById('userInfo').classList.add('hidden');
      showToast('Logged out successfully');
    }

    /* ====================== ADMIN FUNCTIONS ====================== */
    function updateSiteTitle() {
      const newTitle = document.getElementById('siteTitle').value;
      siteData.siteName = newTitle;
      document.getElementById('siteTitle').textContent = newTitle;
      saveData();
      showToast('Site title updated!');
    }

    function uploadLogo(event) {
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          siteData.logo = e.target.result;
          document.getElementById('logoPreview').innerHTML = `<img src="${e.target.result}" class="w-full h-full object-cover">`;
          saveData();
          showToast('Logo uploaded successfully!');
        }
        reader.readAsDataURL(file);
      }
    }

    function changeSiteColor() {
      const color = document.getElementById('siteColor').value;
      document.documentElement.style.setProperty('--primary-color', color);
      siteData.color = color;
      saveData();
    }

    function changeCalendarColor() {
      const color = document.getElementById('calendarColor').value;
      document.documentElement.style.setProperty('--calendar-color', color);
      siteData.calendarColor = color;
      saveData();
    }

    function updateAnnouncement() {
      siteData.announcement = document.getElementById('announcementInput').value;
      saveData();
      showToast('Announcement updated!');
    }

    /* ====================== ROOM MANAGEMENT ====================== */
    function addRoom() {
      const name = document.getElementById('newRoomName').value.trim();
      const capacity = document.getElementById('roomCapacity').value;
      const access = document.getElementById('roomAccess').value;
      const approval = document.getElementById('roomApproval').value === 'yes';
      
      if (!name) {
        showToast('Please enter a room name');
        return;
      }
      
      const newRoom = {
        id: generateId(),
        name,
        capacity: parseInt(capacity) || null,
        access,
        requiresApproval: approval
      };
      
      siteData.rooms.push(newRoom);
      saveData();
      loadRooms();
      showToast('Room added successfully!');
    }

    function loadRooms() {
      const roomList = document.getElementById('roomList');
      roomList.innerHTML = '';
      
      siteData.rooms.forEach(room => {
        const li = document.createElement('li');
        li.className = 'bg-white p-3 rounded-md shadow-sm flex justify-between items-center dark:bg-gray-600';
        li.innerHTML = `
          <div>
            <span class="font-medium">${room.name}</span>
            ${room.capacity ? `<span class="text-sm text-gray-500 ml-2">(${room.capacity} seats)</span>` : ''}
          </div>
          <button onclick="deleteRoom('${room.id}')" class="text-red-600 hover:text-red-800">
            <i class="fas fa-trash"></i>
          </button>
        `;
        roomList.appendChild(li);
      });
    }

    function deleteRoom(roomId) {
      siteData.rooms = siteData.rooms.filter(room => room.id !== roomId);
      saveData();
      loadRooms();
      showToast('Room deleted successfully');
    }

    /* ====================== USER MANAGEMENT ====================== */
    function createUser() {
      const username = document.getElementById('newUsername').value.trim();
      const password = document.getElementById('newPassword').value.trim();
      const email = document.getElementById('newEmail').value.trim();
      const role = document.getElementById('newRole').value;
      
      if (!username || !password) {
        showToast('Username and password are required');
        return;
      }
      
      const newUser = {
        username,
        password,
        role,
        email: email || null,
        avatar: null
      };
      
      siteData.users.push(newUser);
      saveData();
      loadUsers();
      showToast('User created successfully!');
    }

    function loadUsers() {
      const userList = document.getElementById('userList');
      userList.innerHTML = '';
      
      siteData.users.forEach(user => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td class="px-6 py-4 whitespace-nowrap">${user.username}</td>
          <td class="px-6 py-4 whitespace-nowrap">${user.role}</td>
          <td class="px-6 py-4 whitespace-nowrap">${user.email || '-'}</td>
          <td class="px-6 py-4 whitespace-nowrap">
            <button class="text-indigo-600 hover:text-indigo-900" onclick="editUser('${user.username}')">
              <i class="fas fa-edit"></i>
            </button>
            <button class="text-red-600 hover:text-red-900 ml-2" onclick="deleteUser('${user.username}')">
              <i class="fas fa-trash"></i>
            </button>
          </td>
        `;
        userList.appendChild(tr);
      });
    }

    function deleteUser(username) {
      siteData.users = siteData.users.filter(user => user.username !== username);
      saveData();
      loadUsers();
      showToast('User deleted successfully');
    }

    /* ====================== CALENDAR FUNCTIONS ====================== */
    function renderCalendar() {
  const calendarGrid = document.getElementById('calendarGrid');
  calendarGrid.innerHTML = '';

  // Header row for days of the week
  ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].forEach(day => {
    const div = document.createElement('div');
    div.className = 'text-center font-medium py-2 bg-gray-100 dark:bg-gray-700';
    div.textContent = day;
    calendarGrid.appendChild(div);
  });

  // First day of the month
  const date = new Date(currentYear, currentMonth, 1);
  const firstDayIndex = date.getDay(); // 0 = Sunday, 1 = Monday, etc.

  // Add empty cells for days before the first day of the month
  for (let i = 0; i < firstDayIndex; i++) {
    const emptyCell = document.createElement('div');
    calendarGrid.appendChild(emptyCell);
  }

  // Number of days in the month
  const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();

  // Add day cells
  for (let day = 1; day <= daysInMonth; day++) {
    const cellDate = new Date(currentYear, currentMonth, day);
    const dayDiv = document.createElement('div');
    dayDiv.className = 'calendar-day p-2 border rounded-md cursor-pointer hover:bg-gray-50 dark:bg-gray-700 dark:border-gray-600';
    dayDiv.textContent = day;

    // Highlight today's date
    const today = new Date();
    if (
      cellDate.getDate() === today.getDate() &&
      cellDate.getMonth() === today.getMonth() &&
      cellDate.getFullYear() === today.getFullYear()
    ) {
      dayDiv.classList.add('bg-indigo-100', 'dark:bg-indigo-900');
    }

    // Weekend and holiday styling
    if (isWeekend(cellDate)) {
      dayDiv.classList.add('weekend-day');
    }
    if (isHoliday(cellDate)) {
      dayDiv.classList.add('holiday-day');
    }

    calendarGrid.appendChild(dayDiv);
  }

  // Update month/year text properly
  const monthName = date.toLocaleString('default', { month: 'long' });
  document.getElementById('currentMonthYear').textContent = `${monthName} ${currentYear}`;
}

    function changeMonth(offset) {
      currentMonth += offset;
      if (currentMonth > 11) {
        currentMonth = 0;
        currentYear++;
      } else if (currentMonth < 0) {
        currentMonth = 11;
        currentYear--;
      }
      renderCalendar();
    }

    /* ====================== BOOKING FUNCTIONS ====================== */
    function submitBooking(event) {
      event.preventDefault();
      const date = document.getElementById('date').value;
      const room = document.getElementById('roomSelect').value;
      const period = document.getElementById('period').value;
      const notes = document.getElementById('bookingNotes').value;
      
      const newBooking = {
        id: generateId(),
        date,
        room,
        period,
        notes,
        user: currentUser.username,
        status: 'pending',
        timestamp: new Date().toISOString()
      };
      
      siteData.bookings.push(newBooking);
      saveData();
      showToast('Booking submitted for approval!');
      document.getElementById('bookingForm').reset();
    }

    function approveBooking() {
      selectedBooking.status = 'approved';
      saveData();
      closeModal();
      showToast('Booking approved!');
      renderCalendar();
    }

    /* ====================== DARK MODE ====================== */
    function toggleDarkMode() {
      darkMode = !darkMode;
      document.body.classList.toggle('dark-mode');
      localStorage.setItem('darkMode', darkMode);
      document.getElementById('darkModeToggle').innerHTML = 
        darkMode ? '<i class="fas fa-sun"></i>' : '<i class="fas fa-moon"></i>';
    }

    /* ====================== INITIAL LOAD ====================== */
    function loadApp() {
      loadRooms();
      loadUsers();
      renderCalendar();
    }
	function changeMonth(offset) {
  currentMonth += offset;
  if (currentMonth > 11) {
    currentMonth = 0;
    currentYear++;
  } else if (currentMonth < 0) {
    currentMonth = 11;
    currentYear--;
  }
  renderCalendar();
}

function isWeekend(date) {
  return date.getDay() === 0 || date.getDay() === 6;
}

function isHoliday(date) {
  return siteData.holidays.some(h => h.date === date.toISOString().split('T')[0]);
}
  </script>
</body>
</html>
